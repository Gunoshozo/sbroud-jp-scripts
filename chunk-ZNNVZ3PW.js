import{a as b}from"./chunk-FH72FGH4.js";import{a as K,b as h}from"./chunk-VDUGLGSV.js";import{a as J}from"./chunk-BCM33SBB.js";import{a as Q}from"./chunk-G7HPI7UU.js";import{a as q,b as z}from"./chunk-PIVUWUSR.js";import"./chunk-M3MMNDIF.js";import"./chunk-DUNI2MG6.js";import{Ae as V,Be as W,Ca as R,Ea as u,Ia as A,J as _,Ja as C,Ka as N,La as S,M as E,Ma as c,Na as l,Oa as F,Pe as L,Qe as g,Wa as I,Z as T,cb as w,eb as B,ib as $,j as x,jb as j,kb as y,nb as G,ob as P,ta as s,tb as O,ua as p,x as M,xb as D,ye as H}from"./chunk-XP36KMKK.js";var X=()=>({"grid-template-columns":"none"}),Y=()=>({});function Z(i,a){if(i&1&&(F(0,"item-card",3),G(1,"imgLink")),i&2){let r=a.$implicit;u("name",r.name)("link",r.routerLink)("imageResource",P(1,4,r.imgSrc))("spoiler",r.spoiler)}}function ee(i,a){if(i&1&&(c(0,"div",2),N(1,Z,2,6,"item-card",3,C),l()),i&2){let r=I();s(),S(r._items)}}function te(i,a){if(i&1&&(c(0,"a",5)(1,"button",6),w(2),l()()),i&2){let r=a.$implicit;u("routerLink",r.routerLink),s(2),B(" ",r.name,"")}}function ie(i,a){if(i&1&&(c(0,"div",4),N(1,te,3,2,"a",5,C),l()),i&2){let r=I();u("ngClass",r._items.length>20?"search-items-grid":"items-list_container")("ngStyle",r._items.length==1?y(2,X):y(3,Y)),s(),S(r._items)}}var _e=(()=>{let a=class a{constructor(o,e,t,d){this.route=o,this.router=e,this.gameRootService=t,this.restApiService=d,this._items=[],this._routes=!1,this.headerText="",this.hasImages=!1,this.easterEggs=!0,this.gameName=""}ngOnInit(){window.scroll(0,0);let o=[this.route.paramMap];g.mapping||o.push(this.restApiService.get("nameMapping").pipe(E(e=>{g.mapping=e}))),this.route.parent?.paramMap.pipe(M(o),_(e=>{this.easterEggs=localStorage.getItem(L.easterEggs)?localStorage.getItem(L.easterEggs)=="true":!0,this.gameName=e[0].get("gameName");let t=this.router.url.split("/").at(-1);if(this._routes=t==="routes",this._routes)return this.restApiService.get("gameRouteConfig",{pathParams:{gameName:this.gameName}});{let d=e[1].has("routeName")?"routedGameChapterConfig":"nonRoutedGameChapterConfig";return this.restApiService.get(d,{pathParams:{gameName:this.gameName,routeName:e[1].get("routeName")}}).pipe(_(n=>{let f=[],re=n.chapters,k=n.chapterOrder;if(k)k.forEach((m,v)=>{let U=b.resolveChapterName(n,v);f.push({name:U,routerLink:`${m}`})});else for(let m=1;m<=n.total;m++){let v=b.resolveChapterName(n,m);f.push({name:v,routerLink:`${m}`})}return x({headerLabel:n.headerLabel||e[1].get("routeName")&&`${e[1].get("routeName")} route chapters`||`${g.mapping[this.gameName]&&g.mapping[this.gameName]+" "||""}chapters`,items:f})}))}})).subscribe({next:e=>{this.easterEggs&&e?.items.some(t=>t.alternativeImgs)?this._items=e?.items.map(t=>(t.alternativeImgs&&Math.random()>.75&&(t.alternativeImgs.length>1?t.imgSrc=this.selectRandom(t.alternativeImgs):t.imgSrc=t.alternativeImgs[0]),t)):this._items=e?.items,this.hasImages=!!this._items?.some(t=>!!t.imgSrc),e.headerLabel&&this.gameRootService.pushHeader(e.headerLabel)},error:()=>{this.router.navigate(["/error"])}})}selectRandom(o){let e=Math.floor(Math.random()*o.length);return o[e]}};a.\u0275fac=function(e){return new(e||a)(p(H),p(V),p(J),p(h))},a.\u0275cmp=T({type:a,selectors:[["chapter-navigation"]],standalone:!0,features:[$([h]),j],decls:4,vars:1,consts:[[1,"items-list_body"],[1,"items-list_scroll"],[1,"items-list_container",2,"--container-width","80vw"],[3,"name","link","imageResource","spoiler"],[3,"ngClass","ngStyle"],[3,"routerLink"],["appearance","custom","tuiButton","","type","button",1,"items-list_item-button"]],template:function(e,t){e&1&&(c(0,"div",0)(1,"div",1),R(2,ee,3,0,"div",2)(3,ie,3,4),l()()),e&2&&(s(2),A(2,t._routes&&t.hasImages?2:3))},dependencies:[Q,O,D,W,z,q,K],encapsulation:2});let i=a;return i})();export{_e as ChapterNavigationComponent};
